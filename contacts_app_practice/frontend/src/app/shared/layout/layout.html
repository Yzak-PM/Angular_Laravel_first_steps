<div class="min-h-screen bg-slate-50 lg:flex">
  <!-- Overlay (solo móvil) -->
  @if (sidebarOpen()) {
  <div
    class="fixed inset-0 z-40 bg-black/35 lg:hidden"
    (click)="closeSidebar()"
    aria-hidden="true"
  ></div>
  }

  <!-- Sidebar -->
  <aside
    class="fixed inset-y-0 left-0 z-50 w-72 bg-slate-700 text-white shadow-2xl transform transition-transform duration-200 ease-out flex flex-col lg:static lg:translate-x-0 lg:shadow-none"
    [class.-translate-x-full]="!sidebarOpen()"
  >
    <!-- Top / Brand -->
    <div class="h-16 px-5 flex items-center gap-3 border-b border-white/15">
      <div class="h-9 w-9 rounded-full bg-white/10 ring-1 ring-white/15 grid place-items-center">
        <span class="font-bold">E</span>
      </div>
      <div class="leading-tight">
        <div class="font-semibold tracking-wide">ENTHEOSPACE</div>
      </div>
    </div>

    <!-- Nav -->
    <nav class="py-3">
      <a
        routerLink="/contacts"
        routerLinkActive="bg-white/10"
        class="mx-3 flex items-center gap-3 rounded-xl px-4 py-3 hover:bg-white/10 transition border border-transparent"
        (click)="closeSidebar()"
      >
        <svg
          class="h-5 w-5 text-white/80"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
          <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
          <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
        <span class="font-medium">Contacts</span>
      </a>

      @if (permissionState.can('config', 'view')){
        <a
          routerLink="/admin/permissions/contacts"
          routerLinkActive="bg-white/10"
          class="mx-3 flex items-center gap-3 rounded-xl px-4 py-3 hover:bg-white/10 transition border border-transparent"
          (click)="closeSidebar()"
        >
          <svg
            class="h-5 w-5 text-white/80"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
          </svg>
          <span class="font-medium">Role Permissions</span>
        </a>
      }

      <div class="my-3 border-t border-white/15"></div>
      <!-- más links... -->
    </nav>

    <!-- Bottom area (pegado abajo) -->
    <footer class="mt-auto border-t border-white/15 px-5 py-4">
      <!-- User -->
      <div class="flex items-center gap-3">
        <div
          class="h-10 w-10 rounded-full bg-white/10 ring-1 ring-white/15 grid place-items-center"
        >
          <svg
            class="h-6 w-6 text-white/80"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M20 21a8 8 0 1 0-16 0" />
            <circle cx="12" cy="7" r="4" />
          </svg>
        </div>

        <div class="min-w-0 leading-tight">
          <div class="text-sm font-medium truncate">{{ CurrentUser()?.name }}</div>
          <div class="text-xs text-white/60 truncate">{{ CurrentUser()?.email }}</div>
        </div>
      </div>

      <!-- Button -->
      <button
        type="button"
        class="mt-4 w-full rounded-xl px-4 py-2.5 text-sm font-semibold bg-white/10 hover:bg-white/15 transition ring-1 ring-white/15"
        (click)="onLogout()"
      >
        Log out
      </button>

      <!-- Si de verdad quieres que diga "Login" en vez de logout, cambia el texto
         y el handler: (click)="router.navigate(['/auth/login'])" -->
    </footer>
  </aside>

  <!-- Content -->
  <div class="flex-1 min-w-0">
    <!-- Header -->
    <header class="h-14 bg-slate-600 flex items-center px-3 sticky top-0 z-30">
      <button
        type="button"
        class="p-2 rounded-md hover:bg-white/10 active:bg-white/15 lg:hidden"
        aria-label="Open menu"
        [attr.aria-expanded]="sidebarOpen()"
        (click)="toggleSidebar()"
      >
        <svg viewBox="0 0 24 24" class="h-7 w-7 fill-white">
          <path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z" />
        </svg>
      </button>
    </header>

    <!-- Page -->
    <main class="p-4">
      <router-outlet />
    </main>
  </div>
</div>